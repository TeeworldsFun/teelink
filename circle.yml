
# To use GCC and G++ 4.8
machine:
  pre:
    - sudo update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-4.8 10
    - sudo update-alternatives --install /usr/bin/g++ g++ /usr/bin/g++-4.8 10
  environment:
    HCLIENT_VERSION: 4.0.1

# To Build Teeworlds
dependencies:
  pre:
    - |
        sudo apt-get update && sudo apt-get install -y libsdl1.2-dev zlib1g-dev libfreetype6-dev python2.7 libnotify-dev libopus-dev

        if [ ! -x ~/bam-0.5.0/bam ]; then
          wget -O ~/bamv0.5.0.tar.gz https://github.com/matricks/bam/archive/v0.5.0.tar.gz
          tar -zxvf ~/bamv0.5.0.tar.gz -C ~/
          cd ~/bam-0.5.0; ./make_unix.sh
        fi

  cache_directories:
    - "~/bam-0.5.0/"

## Customize test commands
test:
  override:
    - ~/bam-0.5.0/bam release
    - ~/bam-0.5.0/bam debug
    - python2 scripts/make_release.py $HCLIENT_VERSION linux86_64
  ## Artifacts
  post:
    - mv teeworlds* $CIRCLE_ARTIFACTS
    - mv H-Client-*.tar.gz $CIRCLE_ARTIFACTS

